{"version":3,"names":["React","useImperativeHandle","useMemo","useRef","forwardRef","useCallback","PixelRatio","StyleSheet","Skia","useDrawCallback","useTouchHandler","PaintStyle","SkiaView","ImageFormat","DEFAULT_BRUSH_COLOR","DEFAULT_ERASER_SIZE","DEFAULT_OPACITY","DEFAULT_STROKE_CAP","DEFAULT_STROKE_JOIN","DEFAULT_THICKNESS","DEFAULT_TOOL","DEFAULT_CANVAS_BACKGROUND_COLOR","DrawingTool","getSvgHelper","convertCorePathsToSkiaPaths","convertCorePathToSkiaPath","convertInnerPathsToStandardPaths","drawPoint","setPaint","Canvas","_ref","ref","color","thickness","opacity","filled","cap","join","initialPaths","style","height","width","eraserSize","tool","onPathsChange","backgroundColor","debug","shareStrokeProperties","touchDisabled","prevPointRef","skiaViewRef","paths","pathPaint","p","Paint","eraserPoint","x","y","erasing","canvasPaint","setColor","Color","eraserPaint","setStyle","Fill","undo","_skiaViewRef$current","length","Math","max","current","redraw","clear","_skiaViewRef$current2","getPaths","addPath","path","push","addPaths","corePaths","setPaths","splice","getDistance","x1","y1","x2","y2","sqrt","getSvg","getImageSnapshot","_skiaViewRef$current3","xSnapshot","ySnapshot","skRectMaxX","skRectMaxY","forEach","_ref2","skRect","computeTightBounds","widthSnapshot","heightSnapshot","image","makeImageSnapshot","getPixelSizeForLayoutSize","data","encodeToBase64","PNG","url","erasingPaths","reversedPaths","reverse","_ref3","index","contains","touchHandler","onStart","_ref4","Eraser","Path","Make","setIsVolatile","paint","Stroke","moveTo","onActive","_ref5","onEnd","onDraw","canvas","info","touches","_ref6","drawPath","_ref7","drawCircle","createElement","styles","skia","create","overflow"],"sourceRoot":"../../src","sources":["Canvas.tsx"],"mappings":"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"}